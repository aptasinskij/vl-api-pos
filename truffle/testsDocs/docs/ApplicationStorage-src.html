<!doctype html><html> <head> <meta charset="utf-8"> <title>Source code of ApplicationStorage.js</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="stylesheet" href="css/docs.css"> </head> <body id="cjs-src"> <!-- Generated with comment.js --> <pre class="prettyprint linenums cjs-pre"><code class="cjs-code">const assert = require(&#39;chai&#39;).assert;
const ApplicationStorage = artifacts.require(&#39;ApplicationStorage.sol&#39;);
const {convertToNumber} = require(&#39;..&#47;helpers&#39;);

&#47;*\
* ApplicationStorage
\*&#47;

contract(&#39;ApplicationStorage&#39;, () =&#62; {

    describe(&#39;tests for all methods&#39;, () =&#62; {
        let resSave;
        let resGet1;
        let resGet2;
        let resGetApplicationName;
        let resGetApplicationOwner;
        let resGetApplicationUrl;
        let resSetApplicationUrl;
        let resSetApplicationAddress;
        let resGetApplicationAddress;
        let resSetApplicationStatus;
        let resGetApplicationStatus;
        let resGetAfterAll;
        let resCreateApplication;
        let resRetrieveApplication;

        before(async () =&#62; {
            const instance = await ApplicationStorage.deployed();

        let resIsRegistered1;
        let resIsRegistered2;

        before(async () =&#62; {
            const instance = await ApplicationStorage.deployed();
            &#47;* isRegistered *&#47;
            resIsRegistered1 = await instance.isRegistered(456);

            &#47;* save *&#47;
            resSave = await instance.save(1, &#39;app name&#39;, 235, &#39;https:&#47;&#47;my-app-url&#39;, 456, 4);
            resSave = convertToNumber(resSave.logs[0].args);
            &#47;* get *&#47;
            resGet1 = convertToNumber(await instance.get(1));
            &#47;* getApplicationName *&#47;
            resGetApplicationName = await instance.getApplicationName(1);
            &#47;* getApplicationOwner *&#47;
            resGetApplicationOwner = Number(await instance.getApplicationOwner(1));
            &#47;* setApplicationUrl *&#47;
            resSetApplicationUrl = await instance.setApplicationUrl(1, &#39;http:&#47;&#47;new-url&#39;);
            resSetApplicationUrl = convertToNumber(resSetApplicationUrl.logs[0].args);
            &#47;* getApplicationUrl *&#47;
            resGetApplicationUrl = await instance.getApplicationUrl(1);
            &#47;* setApplicationAddress *&#47;
            resSetApplicationAddress = await instance.setApplicationAddress(1, 999);
            resSetApplicationAddress = convertToNumber(resSetApplicationAddress.logs[0].args);
            &#47;* getApplicationAddress *&#47;
            resGetApplicationAddress = Number(await instance.getApplicationAddress(1));
            &#47;* setApplicationStatus *&#47;
            resSetApplicationStatus = await instance.setApplicationStatus(1, 8);
            resSetApplicationStatus = convertToNumber(resSetApplicationStatus.logs[0].args);
            &#47;* getApplicationStatus *&#47;
            resGetApplicationStatus = Number(await instance.getApplicationStatus(1));
            &#47;* get (after all) *&#47;
            resGetAfterAll = convertToNumber(await instance.get(1));

            &#47;* createApplication *&#47;
            resCreateApplication = await instance.createApplication(2, &#39;my app&#39;, 3, &#39;http:&#47;&#47;url&#39;, 4, 0);
            resGet2 = convertToNumber(await instance.get(2));
            &#47;* retrieveApplication *&#47;
            resRetrieveApplication = convertToNumber(await instance.retrieveApplication(2));
            resGetAfterAll = await instance.get(1);
            resGetAfterAll = convertToNumber(resGetAfterAll);
            &#47;* isRegistered *&#47;
            resIsRegistered2 = await instance.isRegistered(456);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; save(appId, name, owner, url, appAddr, status) &#60;&#47;h4&#62;
         # Save new application
         &#62; Arguments
         - (uint256) appId - application id
         - (string) name - application name
         - (address) owner - application owner
         - (string) url - application url
         - (address) appAddr - application address
         - (uint256) status - application status
         &#62; Emits
         - (event) ApplicationSaved
        \*&#47;
        it(&#39;save&#39;, () =&#62; {
            assert.strictEqual(resSave.appId, 1, &#39;application Id is not equal&#39;);
            assert.strictEqual(resSave.name, &#39;app name&#39;, &#39;application name is not equal&#39;);
            assert.strictEqual(resSave.owner, 235, &#39;application owner is not equal&#39;);
            assert.strictEqual(resSave.url, &#39;https:&#47;&#47;my-app-url&#39;, &#39;application url is not equal&#39;);
            assert.strictEqual(resSave.appAddr, 456, &#39;application address is not equal&#39;);
            assert.strictEqual(resSave.status, 4, &#39;application status is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; get(appId) &#60;&#47;h4&#62;
         # Get all info of application
         &#62; Arguments
         - (uint256) appId - application id
         &#62; Returns
         - (string) name - application name
         - (address) owner - application owner
         - (string) url - application url
         - (address) appAddr - application address
         - (uint256) status - application status
        \*&#47;
        it(&#39;get&#39;, () =&#62; {
            assert.strictEqual(resGet1[0], &#39;app name&#39;, &#39;application name is not equal&#39;);
            assert.strictEqual(resGet1[1], 235, &#39;application owner is not equal&#39;);
            assert.strictEqual(resGet1[2], &#39;https:&#47;&#47;my-app-url&#39;, &#39;application url is not equal&#39;);
            assert.strictEqual(resGet1[3], 456, &#39;application address is not equal&#39;);
            assert.strictEqual(resGet1[4], 4, &#39;application status is not equal&#39;);
            &#47;* after all *&#47;
            assert.strictEqual(resGetAfterAll[0], &#39;app name&#39;, &#39;application name is not equal (after all)&#39;);
            assert.strictEqual(resGetAfterAll[1], 235, &#39;application owner is not equal (after all)&#39;);
            assert.strictEqual(resGetAfterAll[2], &#39;http:&#47;&#47;new-url&#39;, &#39;application url is not equal (after all)&#39;);
            assert.strictEqual(resGetAfterAll[3], 999, &#39;application address is not equal (after all)&#39;);
            assert.strictEqual(resGetAfterAll[4], 8, &#39;application status is not equal (after all)&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; isRegistered(_applicationAddress) &#60;&#47;h4&#62;
         # Get application registration state
         &#62; Arguments
         - (address) _applicationAddress - application id
         &#62; Returns
         - (bool) isRegistered - application registration state
        \*&#47;
        it(&#39;isRegistered&#39;, () =&#62; {
            assert.strictEqual(resIsRegistered1, false, &#39;application is registered before registration&#39;);
            assert.strictEqual(resIsRegistered2, true, &#39;application is not registered after registration&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; getApplicationName(appId) &#60;&#47;h4&#62;
         # Get name of application
         &#62; Arguments
         - (uint256) appId - application id
         &#62; Returns
         - (string) name - application name
        \*&#47;
        it(&#39;getApplicationName&#39;, () =&#62; {
            assert.strictEqual(resGetApplicationName, &#39;app name&#39;, &#39;application name is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; getApplicationOwner(appId) &#60;&#47;h4&#62;
         # Get owner of application
         &#62; Arguments
         - (uint256) appId - application id
         &#62; Returns
         - (address) owner - application owner
        \*&#47;
        it(&#39;getApplicationOwner&#39;, () =&#62; {
            assert.strictEqual(resGetApplicationOwner, 235, &#39;application owner is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; setApplicationUrl(appId, url) &#60;&#47;h4&#62;
         # Set url of application
         &#62; Arguments
         - (uint256) appId - application id
         - (string) url - application url
         &#62; Emits
         - (event) ApplicationUrlUpdated
        \*&#47;
        it(&#39;setApplicationUrl&#39;, () =&#62; {
            assert.strictEqual(resSetApplicationUrl.appId, 1, &#39;application Id is not equal&#39;);
            assert.strictEqual(resSetApplicationUrl.url, &#39;http:&#47;&#47;new-url&#39;, &#39;application url is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; getApplicationUrl(appId) &#60;&#47;h4&#62;
         # Get url of application
         &#62; Arguments
         - (uint256) appId - application id
         &#62; Returns
         - (string) url - application url
        \*&#47;
        it(&#39;getApplicationUrl&#39;, () =&#62; {
            assert.strictEqual(resGetApplicationUrl, &#39;http:&#47;&#47;new-url&#39;, &#39;application url is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; setApplicationAddress(appId, appAddr) &#60;&#47;h4&#62;
         # Set address of application
         &#62; Arguments
         - (uint256) appId - application id
         - (address) appAddr - application address
         &#62; Emits
         - (event) ApplicationAddressUpdated
        \*&#47;
        it(&#39;setApplicationAddress&#39;, () =&#62; {
            assert.strictEqual(resSetApplicationAddress.appId, 1, &#39;application Id is not equal&#39;);
            assert.strictEqual(resSetApplicationAddress.appAddr, 999, &#39;application address is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; getApplicationAddress(appId) &#60;&#47;h4&#62;
         # Get address of application
         &#62; Arguments
         - (uint256) appId - application id
         &#62; Returns
         - (address) appAddr - application address
        \*&#47;
        it(&#39;getApplicationAddress&#39;, () =&#62; {
            assert.strictEqual(resGetApplicationAddress, 999, &#39;application url is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; setApplicationStatus(appId) &#60;&#47;h4&#62;
         # Set status of application
         &#62; Arguments
         - (uint256) appId - application id
         &#62; Emits
         - (event) ApplicationStatusUpdated
        \*&#47;
        it(&#39;setApplicationStatus&#39;, () =&#62; {
            assert.strictEqual(resSetApplicationStatus.appId, 1, &#39;application Id is not equal&#39;);
            assert.strictEqual(resSetApplicationStatus.status, 8, &#39;application status is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; getApplicationStatus(appId) &#60;&#47;h4&#62;
         # Get status of application
         &#62; Arguments
         - (uint256) appId - application id
         &#62; Returns
         - (uint256) status - application status
        \*&#47;
        it(&#39;getApplicationStatus&#39;, () =&#62; {
            assert.strictEqual(resGetApplicationStatus, 8, &#39;application status is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; createApplication(_Id, _name, _owner, _url, _appAddr, _status) &#60;&#47;h4&#62;
         # Create new application using structure approach
         &#62; Arguments
         - (uint256) _Id - application id
         - (string) _name - application name
         - (address) _owner - owner address
         - (string) _url - application url
         - (address) _appAddr - application address
         - (uint256) _status - application status
        \*&#47;
        it(&#39;createApplication&#39;, () =&#62; {
            &#47;* from resCreateApplication method *&#47;
            assert.notEqual(resCreateApplication.receiptIdUrl.transactionHash, &#39;&#39;, &#39;transaction hash is empty&#39;);
            assert.isAbove(resCreateApplication.receiptIdUrl.gasUsed, 0, &#39;gasUsed is 0&#39;);
            &#47;* from get method *&#47;
            assert.strictEqual(resGet2[0], &#39;my app&#39;, &#39;application name is not equal&#39;);
            assert.strictEqual(resGet2[1], 3, &#39;owner address is not equal&#39;);
            assert.strictEqual(resGet2[2], &#39;http:&#47;&#47;url&#39;, &#39;application url is not equal&#39;);
            assert.strictEqual(resGet2[3], 4, &#39;application address is not equal&#39;);
            assert.strictEqual(resGet2[4], 0, &#39;application status is not equal&#39;);
        });

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; retrieveApplication(_id) &#60;&#47;h4&#62;
         # Get full application info using structure approach
         &#62; Arguments
         - (uint256) _id - application id
         &#62; Returns
         - (string) _name - application name
         - (address) _owner - owner address
         - (string) _url - application url
         - (address) _appAddr - application address
         - (uint256) _status - application status
        \*&#47;
        it(&#39;retrieveApplication&#39;, () =&#62; {
            assert.strictEqual(resRetrieveApplication[0], &#39;my app&#39;, &#39;application name is not equal&#39;);
            assert.strictEqual(resRetrieveApplication[1], 3, &#39;owner address is not equal&#39;);
            assert.strictEqual(resRetrieveApplication[2], &#39;http:&#47;&#47;url&#39;, &#39;application url is not equal&#39;);
            assert.strictEqual(resRetrieveApplication[3], 4, &#39;application address is not equal&#39;);
            assert.strictEqual(resRetrieveApplication[4], 0, &#39;application status is not equal&#39;);
        });

        &#47;* events description *&#47;

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; ApplicationSaved &#60;&#47;h4&#62;
         # Get full info of saved application (emits on &#34;save&#34; method call)
         &#62; Returns
         - (uint256) appId - application id
         - (string) name - application name
         - (address) owner - application owner
         - (string) url - application url
         - (address) appAddr - application address
         - (uint256) status - application status
        \*&#47;

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; ApplicationUrlUpdated &#60;&#47;h4&#62;
         # Get updated url of application (emits on &#34;setApplicationUrl&#34; method call)
         &#62; Returns
         - (uint256) appId - application id
         - (string) url - application url
        \*&#47;

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; ApplicationAddressUpdated &#60;&#47;h4&#62;
         # Get updated address of application (emits on &#34;getApplicationAddress&#34; method call)
         &#62; Returns
         - (uint256) appId - application id
         - (address) appAddr - application address
        \*&#47;

        &#47;*\
         # &#60;hr&#62;
         # &#60;h4&#62; ApplicationStatusUpdated &#60;&#47;h4&#62;
         # Get updated status of application (emits on &#34;setApplicationStatus&#34; method call)
         &#62; Returns
         - (uint256) appId - application id
         - (uint256) status - application status
        \*&#47;
    })
});
</code></pre> <script src="js/prettify.js"></script> <script src="js/src.js"></script> </body></html>